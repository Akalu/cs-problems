package org.problems.topology;

import java.util.ArrayList;
import java.util.Comparator;
import java.util.List;
import java.util.stream.Collectors;

/**
 * Maximum Number of Events That Can Be Attended
 * https://leetcode.com/problems/maximum-number-of-events-that-can-be-attended/
 * 
 * Given an array of events where events[i] = [startDayi, endDayi]. Every event
 * i starts at startDayi and ends at endDayi.
 * 
 * You can attend an event i at any day d where startTimei <= d <= endTimei.
 * Notice that you can only attend one event at any time d.
 * 
 * Return the maximum number of events you can attend.
 * 
 * 
 * 
 * Runtime: 97 ms, faster than 33.33% of Java online submissions for Maximum
 * Number of Events That Can Be Attended. Memory Usage: 71.8 MB, less than
 * 100.00% of Java online submissions for Maximum Number of Events That Can Be
 * Attended.
 */
public class MaxEvents {

	public static class Event {
		int len;
		int[] range;

		public Event(int[] range) {
			this.len = range[1] - range[0] + 1;
			this.range = range;
		}

		public int getStart() {
			return range[0];
		}

		@Override
		public String toString() {
			return String.format("%d,[%d,%d]", len, range[0], range[1]);
		}

	}

	public static int calcMaxEvents(List<Event> all, int last, Comparator<Event> c) {

		int[][] reserve = new int[last + 1][2];

		all = all.stream().sorted(c).collect(Collectors.toList());
		boolean[] schedule = new boolean[last + 1];
		int counter = 0;
		for (Event e : all) {
			boolean found = false;
			for (int i = e.range[0]; i < e.range[1] + 1; i++) {
				if (!schedule[i]) {
					schedule[i] = true;
					counter++;
					reserve[i][0] = i + 1;
					reserve[i][1] = e.range[1] + 1;
					found = true;
					break;
				}
			}
			if (!found) {
				for (int i = e.range[0]; i < e.range[1] + 1; i++) {
					if (reserve[i][1] - reserve[i][0] > 0) {
						int min = reserve[i][0];
						int max = reserve[i][1];

						for (int j = min; j < max; j++) {
							if (!schedule[j]) {
								schedule[j] = true;
								counter++;
								reserve[i][0] = j + 1;
								break;
							}
						}
					}
				}

			}
		}
		return counter;

	}

	public int maxEvents(int[][] events) {
		List<Event> all = new ArrayList<>();
		int first = 1;
		int last = 1;

		for (int i = 0; i < events.length; i++) {
			all.add(new Event(events[i]));
			first = first > events[i][0] ? events[i][0] : first;
			last = last < events[i][1] ? events[i][1] : last;
		}

		Comparator<Event> sortBylen = (p, o) -> Integer.compare(p.len, o.len);// asc
		Comparator<Event> sortByStart = (p, o) -> Integer.compare(p.getStart(), o.getStart());// asc

		int res1 = calcMaxEvents(all, last, sortBylen.thenComparing(sortByStart));
		// int res2 = calcMaxEvents(all,last,sortByStart.thenComparing(sortBylen));
		int res2 = 1;

		return Math.max(res1, res2);

	}

	public static void main(String[] arg) {
		MaxEvents cls = new MaxEvents();

		int[][] events1 = { { 1, 2 }, { 2, 3 }, { 3, 4 } };// 3

		System.out.println(cls.maxEvents(events1));

		int[][] events2 = { { 1, 4 }, { 4, 4 }, { 2, 2 }, { 3, 4 }, { 1, 1 } };// 4

		System.out.println(cls.maxEvents(events2));

		int[][] events3 = { { 1, 2 }, { 2, 3 }, { 3, 4 }, { 1, 2 } };// 4

		System.out.println(cls.maxEvents(events3));

		int[][] events4 = { { 1, 3 }, { 1, 3 }, { 1, 3 }, { 3, 4 } };// 4

		System.out.println(cls.maxEvents(events4));

		int[][] events5 = { { 1, 2 }, { 1, 2 }, { 3, 3 }, { 1, 5 }, { 1, 5 } };// 5

		System.out.println(cls.maxEvents(events5));

		int[][] events6 = { { 25, 26 }, { 19, 19 }, { 9, 13 }, { 16, 17 }, { 17, 18 }, { 20, 21 }, { 22, 25 },
				{ 11, 12 }, { 19, 23 }, { 7, 9 }, { 1, 1 }, { 21, 23 }, { 14, 14 }, { 4, 7 }, { 16, 16 }, { 24, 28 },
				{ 16, 18 }, { 4, 5 }, { 18, 20 }, { 16, 16 }, { 25, 26 } };// 19

		System.out.println(cls.maxEvents(events6));

		int[][] events7 = { { 915, 1835 }, { 392, 1338 }, { 735, 1092 }, { 998, 1751 }, { 723, 1597 }, { 66, 369 },
				{ 441, 948 }, { 965, 1915 }, { 616, 1278 }, { 720, 883 }, { 417, 1112 }, { 452, 1075 }, { 43, 839 },
				{ 211, 332 }, { 638, 1285 }, { 521, 776 }, { 642, 897 }, { 71, 876 }, { 576, 810 }, { 554, 996 },
				{ 962, 1862 }, { 714, 1294 }, { 282, 899 }, { 737, 1189 }, { 495, 830 }, { 639, 1137 }, { 41, 831 },
				{ 115, 1051 }, { 248, 1028 }, { 637, 1616 }, { 280, 417 }, { 309, 1088 }, { 176, 1064 }, { 989, 1381 },
				{ 681, 1254 }, { 620, 1457 }, { 595, 1549 }, { 797, 1244 }, { 409, 653 }, { 151, 621 }, { 636, 785 },
				{ 739, 1655 }, { 963, 1061 }, { 720, 1272 }, { 799, 1184 }, { 705, 1320 }, { 18, 563 }, { 473, 755 },
				{ 173, 846 }, { 224, 249 }, { 526, 1095 }, { 437, 1063 }, { 94, 1026 }, { 288, 637 }, { 670, 1113 },
				{ 828, 1227 }, { 691, 871 }, { 472, 784 }, { 289, 980 }, { 182, 696 }, { 507, 777 }, { 364, 1106 },
				{ 398, 1126 }, { 244, 272 }, { 900, 1067 }, { 28, 353 }, { 596, 1259 }, { 394, 1068 }, { 703, 820 },
				{ 284, 689 }, { 893, 1152 }, { 838, 1568 }, { 911, 939 }, { 563, 1508 }, { 354, 1019 }, { 86, 865 },
				{ 460, 894 }, { 102, 822 }, { 39, 258 }, { 795, 1131 }, { 229, 436 }, { 571, 1437 }, { 308, 407 },
				{ 626, 1572 }, { 777, 1261 }, { 377, 538 }, { 549, 634 }, { 772, 1189 }, { 951, 1202 }, { 558, 1147 },
				{ 633, 956 }, { 665, 1335 }, { 396, 736 }, { 681, 939 }, { 938, 1533 }, { 397, 1071 }, { 872, 1259 },
				{ 674, 754 }, { 301, 1248 }, { 630, 656 }, { 817, 1350 }, { 611, 681 }, { 181, 953 }, { 463, 655 },
				{ 786, 1542 }, { 83, 1063 }, { 803, 804 }, { 191, 1094 }, { 973, 1922 }, { 893, 1532 }, { 910, 1312 },
				{ 879, 1697 }, { 990, 1322 }, { 847, 1350 }, { 22, 233 }, { 131, 932 }, { 237, 702 }, { 24, 431 },
				{ 244, 532 }, { 564, 927 }, { 793, 1468 }, { 702, 1229 }, { 4, 507 }, { 166, 950 }, { 799, 1642 },
				{ 822, 1471 }, { 348, 832 }, { 588, 1410 }, { 512, 1389 }, { 571, 1079 }, { 121, 987 }, { 65, 996 },
				{ 70, 744 }, { 449, 1088 }, { 176, 478 }, { 707, 1130 }, { 852, 1424 }, { 321, 1045 }, { 374, 957 },
				{ 837, 1558 }, { 497, 1108 }, { 190, 202 }, { 105, 1104 }, { 304, 453 }, { 520, 1409 }, { 262, 530 },
				{ 483, 884 }, { 608, 1014 }, { 33, 554 }, { 526, 1131 }, { 418, 1087 }, { 85, 294 }, { 217, 323 },
				{ 802, 1516 }, { 455, 918 }, { 672, 764 }, { 849, 1195 }, { 670, 875 }, { 477, 1435 }, { 945, 1934 },
				{ 521, 1507 }, { 284, 1160 }, { 59, 670 }, { 113, 391 }, { 469, 914 }, { 120, 633 }, { 562, 1199 },
				{ 913, 1789 }, { 910, 1019 }, { 948, 1108 }, { 393, 959 }, { 122, 1006 }, { 212, 902 }, { 629, 1430 },
				{ 538, 1165 }, { 52, 560 }, { 277, 971 }, { 731, 1720 }, { 250, 606 }, { 31, 782 }, { 699, 1575 },
				{ 34, 610 }, { 998, 1450 }, { 882, 1117 }, { 225, 503 }, { 481, 959 }, { 703, 1176 }, { 767, 1750 },
				{ 708, 1107 }, { 699, 811 }, { 3, 71 }, { 526, 994 }, { 648, 1036 }, { 607, 624 }, { 79, 457 },
				{ 328, 502 }, { 751, 1096 }, { 881, 1861 }, { 791, 1476 }, { 407, 440 }, { 187, 683 }, { 57, 906 },
				{ 250, 585 }, { 564, 1226 }, { 40, 48 }, { 894, 1555 }, { 558, 640 }, { 286, 647 }, { 604, 1439 },
				{ 453, 1404 }, { 227, 702 }, { 120, 360 }, { 998, 1172 }, { 318, 520 }, { 641, 826 }, { 801, 864 },
				{ 94, 932 }, { 325, 1313 }, { 500, 928 }, { 519, 1468 }, { 938, 1425 }, { 940, 1522 }, { 759, 800 },
				{ 103, 410 }, { 568, 915 }, { 257, 1220 }, { 580, 1392 }, { 389, 567 }, { 45, 947 }, { 578, 718 },
				{ 105, 720 }, { 134, 576 }, { 161, 755 }, { 74, 965 }, { 105, 1069 }, { 592, 1473 }, { 406, 1142 },
				{ 253, 594 }, { 766, 1102 }, { 745, 1336 }, { 409, 568 }, { 655, 836 }, { 78, 825 }, { 208, 991 },
				{ 29, 42 }, { 210, 1148 }, { 696, 909 }, { 563, 1515 }, { 803, 821 }, { 187, 852 }, { 900, 1183 },
				{ 476, 963 }, { 951, 1314 }, { 707, 824 }, { 972, 1923 }, { 101, 1031 }, { 727, 1486 }, { 273, 506 },
				{ 150, 574 }, { 928, 1202 }, { 61, 996 }, { 740, 1404 }, { 899, 1846 }, { 779, 1396 }, { 354, 842 },
				{ 150, 287 }, { 323, 413 }, { 208, 1043 }, { 825, 1493 }, { 706, 1355 }, { 734, 1269 }, { 42, 349 },
				{ 535, 985 }, { 353, 515 }, { 27, 39 }, { 929, 1636 }, { 297, 440 }, { 381, 448 }, { 911, 1048 },
				{ 418, 544 }, { 858, 1324 }, { 940, 1860 }, { 108, 406 }, { 488, 1392 }, { 952, 1668 }, { 15, 86 },
				{ 131, 242 }, { 154, 181 }, { 834, 1745 }, { 315, 456 }, { 579, 1356 }, { 790, 799 }, { 218, 249 },
				{ 728, 811 }, { 776, 1511 }, { 487, 1332 }, { 389, 655 }, { 133, 656 }, { 914, 1369 }, { 282, 672 },
				{ 775, 1095 }, { 389, 1219 }, { 839, 1058 }, { 211, 1074 }, { 490, 1307 }, { 295, 752 }, { 229, 553 },
				{ 483, 697 }, { 267, 1079 }, { 534, 732 }, { 908, 1310 }, { 924, 1001 }, { 568, 1434 }, { 809, 1679 },
				{ 632, 943 }, { 585, 1231 }, { 934, 1035 }, { 396, 653 }, { 387, 998 }, { 805, 1231 }, { 652, 1296 },
				{ 666, 1397 }, { 766, 1546 }, { 364, 1329 }, { 263, 826 }, { 542, 860 }, { 674, 982 }, { 544, 1423 },
				{ 318, 813 }, { 389, 917 }, { 546, 1043 }, { 709, 793 }, { 662, 1589 }, { 321, 1083 }, { 228, 1001 },
				{ 247, 704 }, { 939, 1310 }, { 243, 506 }, { 411, 893 }, { 880, 1295 }, { 750, 991 }, { 57, 1027 },
				{ 213, 1048 }, { 242, 650 }, { 913, 1326 }, { 59, 388 }, { 697, 1261 }, { 77, 452 }, { 492, 1022 },
				{ 14, 17 }, { 348, 1088 }, { 862, 1170 }, { 352, 995 }, { 931, 1075 }, { 900, 1854 }, { 398, 762 },
				{ 292, 555 }, { 642, 850 }, { 116, 932 }, { 732, 1010 }, { 363, 908 }, { 31, 880 }, { 68, 296 },
				{ 620, 1556 }, { 195, 1106 }, { 655, 1068 }, { 225, 857 }, { 332, 1245 }, { 426, 1127 }, { 242, 1013 },
				{ 921, 1402 }, { 55, 355 }, { 829, 1827 }, { 408, 1177 }, { 272, 372 }, { 935, 1511 }, { 244, 568 },
				{ 515, 609 }, { 589, 1385 }, { 33, 661 }, { 960, 1902 }, { 119, 1062 }, { 537, 996 }, { 510, 759 },
				{ 150, 916 }, { 838, 1688 }, { 815, 1620 }, { 316, 1195 }, { 727, 1388 }, { 839, 1173 }, { 474, 1030 },
				{ 971, 1495 }, { 743, 1693 }, { 246, 729 }, { 936, 977 }, { 577, 1214 }, { 293, 667 }, { 171, 334 },
				{ 709, 890 }, { 390, 588 }, { 419, 728 }, { 792, 1104 }, { 148, 1084 }, { 447, 1107 }, { 508, 550 },
				{ 752, 1644 }, { 830, 1156 }, { 505, 856 }, { 939, 1202 }, { 172, 506 }, { 712, 1583 }, { 751, 1256 },
				{ 272, 1244 }, { 608, 893 }, { 529, 1365 }, { 376, 710 }, { 63, 962 }, { 766, 1341 }, { 481, 638 },
				{ 705, 772 }, { 764, 1154 }, { 331, 966 }, { 876, 1619 }, { 880, 1757 }, { 948, 1598 }, { 218, 943 },
				{ 909, 1347 }, { 666, 1630 }, { 457, 1256 }, { 214, 939 }, { 857, 1529 }, { 692, 873 }, { 602, 1111 },
				{ 898, 1037 }, { 989, 1029 }, { 538, 604 }, { 238, 561 }, { 851, 1117 }, { 700, 1181 }, { 662, 830 },
				{ 620, 828 }, { 853, 1502 }, { 382, 764 }, { 619, 633 }, { 198, 898 }, { 501, 954 }, { 481, 1228 },
				{ 47, 496 }, { 947, 1446 }, { 217, 555 }, { 870, 1741 }, { 793, 1033 }, { 74, 196 }, { 549, 798 },
				{ 488, 1191 }, { 303, 885 }, { 768, 1473 }, { 141, 740 }, { 368, 388 }, { 663, 1411 }, { 24, 255 },
				{ 180, 897 }, { 120, 804 }, { 550, 1228 }, { 194, 288 }, { 547, 1437 }, { 650, 720 }, { 171, 701 },
				{ 385, 393 }, { 426, 575 }, { 329, 530 }, { 474, 1354 }, { 269, 1000 }, { 716, 1117 }, { 589, 1352 },
				{ 899, 1393 }, { 187, 1106 }, { 375, 1051 }, { 107, 425 }, { 902, 1509 }, { 253, 650 }, { 666, 910 },
				{ 813, 1449 }, { 965, 1294 }, { 796, 1432 }, { 725, 938 }, { 750, 822 }, { 471, 1092 }, { 48, 405 },
				{ 601, 882 }, { 722, 813 }, { 846, 1634 }, { 962, 1256 }, { 961, 1004 }, { 441, 1329 }, { 758, 1616 },
				{ 620, 822 }, { 217, 913 }, { 978, 1750 }, { 56, 461 }, { 852, 1178 }, { 339, 903 }, { 763, 878 },
				{ 440, 1345 }, { 421, 1208 }, { 447, 845 }, { 155, 640 }, { 915, 1253 }, { 991, 1036 }, { 990, 1279 },
				{ 876, 1566 }, { 716, 764 }, { 689, 756 }, { 10, 948 }, { 549, 692 }, { 666, 1022 }, { 759, 1606 },
				{ 890, 1337 }, { 345, 1071 }, { 293, 609 }, { 532, 882 }, { 380, 618 }, { 182, 1090 }, { 233, 951 },
				{ 674, 1135 }, { 551, 1261 }, { 67, 169 }, { 850, 1160 }, { 911, 1114 }, { 282, 898 }, { 928, 1752 },
				{ 468, 723 }, { 609, 867 }, { 119, 246 }, { 374, 846 }, { 404, 499 }, { 701, 1187 }, { 69, 554 },
				{ 510, 1485 }, { 259, 1044 }, { 425, 700 }, { 276, 657 }, { 480, 1287 }, { 841, 1658 }, { 82, 959 },
				{ 643, 1604 }, { 799, 898 }, { 190, 677 }, { 500, 1056 }, { 320, 798 }, { 667, 1312 }, { 824, 1351 },
				{ 725, 1060 }, { 333, 392 }, { 861, 1326 }, { 732, 1343 }, { 470, 1232 }, { 68, 690 }, { 299, 1012 },
				{ 795, 1586 }, { 836, 1204 }, { 680, 1502 }, { 553, 908 }, { 482, 671 }, { 23, 512 }, { 704, 1478 },
				{ 700, 1055 }, { 380, 875 }, { 906, 1047 }, { 419, 724 }, { 375, 652 }, { 485, 1394 }, { 698, 1444 },
				{ 91, 969 }, { 795, 873 }, { 60, 188 }, { 889, 1646 }, { 235, 938 }, { 174, 770 }, { 507, 1219 },
				{ 330, 385 }, { 313, 890 }, { 830, 1579 }, { 309, 1188 }, { 849, 1415 }, { 942, 1201 }, { 266, 1109 },
				{ 755, 1318 }, { 207, 1195 }, { 15, 30 }, { 89, 706 }, { 2, 570 }, { 685, 1379 }, { 508, 1027 },
				{ 924, 1415 }, { 270, 1125 }, { 999, 1188 }, { 455, 485 }, { 699, 1225 }, { 983, 1346 }, { 352, 1217 },
				{ 150, 529 }, { 535, 1534 }, { 827, 836 }, { 109, 304 }, { 817, 1592 }, { 504, 1221 }, { 570, 875 },
				{ 366, 1056 }, { 99, 476 }, { 513, 626 }, { 737, 1528 }, { 736, 1351 }, { 786, 906 }, { 939, 1360 },
				{ 86, 419 }, { 504, 1346 }, { 20, 705 }, { 398, 530 }, { 824, 1135 }, { 700, 1462 }, { 165, 754 },
				{ 217, 1175 }, { 779, 1325 }, { 188, 954 }, { 469, 1086 }, { 121, 833 }, { 828, 985 }, { 604, 729 },
				{ 994, 1458 }, { 456, 1304 }, { 562, 1539 }, { 129, 656 }, { 931, 971 }, { 241, 775 }, { 2, 579 },
				{ 988, 1982 }, { 775, 1581 }, { 141, 1117 }, { 185, 1132 }, { 443, 785 }, { 157, 1037 }, { 919, 1591 },
				{ 674, 1407 }, { 119, 1041 }, { 467, 774 }, { 368, 662 }, { 164, 366 }, { 394, 1196 }, { 652, 773 },
				{ 993, 1505 }, { 427, 1197 }, { 263, 822 }, { 118, 1046 }, { 676, 1636 }, { 358, 1185 }, { 826, 1166 },
				{ 1000, 1280 }, { 327, 1318 }, { 74, 515 }, { 61, 925 }, { 773, 1115 }, { 732, 1389 }, { 779, 832 },
				{ 44, 275 }, { 137, 993 }, { 982, 1171 }, { 505, 715 }, { 126, 375 }, { 705, 1255 }, { 873, 1213 },
				{ 979, 1931 }, { 703, 742 }, { 876, 1402 }, { 484, 1353 }, { 647, 882 }, { 523, 1277 }, { 143, 771 },
				{ 129, 1089 }, { 992, 1929 }, { 531, 1039 }, { 622, 1535 }, { 565, 1090 }, { 771, 1109 }, { 354, 778 },
				{ 834, 1673 }, { 38, 440 }, { 943, 1783 }, { 214, 441 }, { 532, 695 }, { 18, 302 }, { 956, 1447 },
				{ 301, 537 }, { 308, 1007 }, { 579, 1062 }, { 889, 1851 }, { 402, 459 }, { 675, 1003 }, { 437, 951 },
				{ 965, 1048 }, { 876, 1155 }, { 62, 689 }, { 645, 1377 }, { 631, 1389 }, { 278, 300 }, { 194, 694 },
				{ 947, 1751 }, { 140, 852 }, { 30, 915 }, { 355, 1119 }, { 569, 1105 }, { 91, 319 }, { 818, 1564 },
				{ 981, 1832 }, { 53, 99 }, { 273, 700 }, { 713, 1630 }, { 311, 1125 }, { 88, 347 }, { 270, 529 },
				{ 352, 981 }, { 529, 1436 }, { 943, 1582 }, { 185, 267 }, { 681, 1453 }, { 588, 1045 }, { 973, 1866 },
				{ 384, 1338 }, { 840, 950 }, { 688, 1092 }, { 895, 1521 }, { 151, 525 }, { 269, 594 }, { 510, 966 },
				{ 77, 306 }, { 189, 802 }, { 515, 964 }, { 223, 438 }, { 165, 341 }, { 812, 855 }, { 232, 651 },
				{ 213, 688 }, { 455, 790 }, { 654, 818 }, { 563, 1308 }, { 113, 463 }, { 648, 1435 }, { 81, 587 },
				{ 653, 831 }, { 724, 1293 }, { 749, 946 }, { 760, 771 }, { 54, 968 }, { 722, 1227 }, { 832, 1064 },
				{ 342, 446 }, { 792, 862 }, { 162, 337 }, { 855, 999 }, { 297, 469 }, { 822, 1472 }, { 907, 1270 },
				{ 415, 657 }, { 276, 626 }, { 289, 798 }, { 565, 1480 }, { 408, 497 }, { 417, 1144 }, { 316, 1148 },
				{ 674, 751 }, { 161, 890 }, { 234, 1119 }, { 830, 1081 }, { 389, 773 }, { 299, 1194 }, { 653, 1474 },
				{ 49, 748 }, { 643, 843 }, { 885, 1235 }, { 107, 618 }, { 406, 1374 }, { 571, 1224 }, { 575, 1575 },
				{ 945, 1537 }, { 586, 921 }, { 181, 818 }, { 375, 919 }, { 84, 661 }, { 855, 1127 }, { 935, 1215 },
				{ 506, 953 }, { 43, 521 }, { 151, 766 }, { 974, 1007 }, { 922, 1513 }, { 683, 885 }, { 492, 1349 },
				{ 59, 190 }, { 797, 1499 }, { 657, 1577 }, { 150, 324 }, { 814, 838 }, { 123, 740 }, { 248, 1105 },
				{ 790, 1508 }, { 612, 872 }, { 101, 977 }, { 491, 1480 }, { 723, 761 }, { 694, 1090 }, { 252, 942 },
				{ 307, 328 }, { 703, 1173 }, { 956, 1853 }, { 691, 1085 }, { 755, 1468 }, { 249, 408 }, { 229, 1157 },
				{ 511, 864 }, { 966, 1629 }, { 820, 995 }, { 557, 1319 }, { 359, 395 }, { 830, 1553 }, { 820, 1808 },
				{ 898, 1087 }, { 171, 262 } };// 827

		System.out.println(cls.maxEvents(events7));
	}

}
